<div *ngIf="!chapter; else view">
  [LOADING]
</div>

<ng-template #view>
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a routerLink="/story">Histoire</a></li>
    <li class="breadcrumb-item active">{{ chapter.getCategory() }}</li>
    <li class="breadcrumb-item active">{{ chapter.getTitle() }}</li>
  </ol>

  <img [src]="image" *ngIf="image" />

  <div class="submenu">
    <button type="button" class="btn" (click)="previous()" *ngIf="chapter.previousChapter">Chapitre pr√©c√©dent</button>
    <button type="button" class="btn btn-primary" (click)="next()" *ngIf="chapter.nextChapter">Chapitre suivant</button>
    <button type="button" class="btn" (click)="goLink(chapter)">Lien YT</button>
  </div>

  <h2>Informations</h2>

  <ul>
    <li><strong>R√©f. :</strong> {{ chapter.ref }}</li>
    <li *ngIf="chapter.title"><strong>Titre :</strong> {{ chapter.title }}</li>
    <li><strong>Publication :</strong> {{ chapter.date }}</li>
    <li>
      <strong>Nombre d'√©pisodes :</strong> {{ chapter.nbEpisodes }}
    </li>
    <li>
      <strong><a routerLink="/version">Qualit√© des √©pisodes</a> :</strong>
      <span [class.qualityMax]="chapter.quality === 100">{{ chapter.quality }}%</span>
    </li>
    <li><strong>Dur√©e totale :</strong> {{ chapter.totalDuration }}</li>
  </ul>

  <h2>Episodes ({{ chapter.displayNbEpisodes() }})</h2>

  <div class="container">

    <table>
      <tr>
        <th>Ref</th>
        <th>Titre</th>
        <th>Dur√©e</th>
        <th *ngIf="hasRegions">R√©gion</th>
        <th><a routerLink="/version">Version</a></th>
      </tr>
      <tr *ngFor="let episode of chapter.episodes; let i = index">
        <td class="ref">
          {{ episode.ref }}
        </td>
        <td>
          <span *ngIf="episode.video else noVideo">
            <a routerLink="/episode/{{ episode.getRefForUrl() }}" *ngIf="episode.title">{{ episode.title }}</a>
            <a routerLink="/episode/{{ episode.getRefForUrl() }}" *ngIf="episode.originalTitle"><em>{{ episode.originalTitle }}</em></a>
          </span>
          <ng-template #noVideo><em>{{ episode.title }}</em></ng-template>
        </td>
        <td>
          <span *ngIf="episode.video">{{ episode.video.duration }}</span>
        </td>
        <td *ngIf="hasRegions">
          {{ episode.region }} <span *ngIf="episode.isTown">üè†</span>
        </td>
        <td>
          <span *ngIf="episode.video">
            <span [class.qualityMax]="episode.video && episode.video.version >= 5">
              {{ episode.video.version }}
            </span>
          </span>
        </td>
      </tr>
    </table>
  </div>
</ng-template>
